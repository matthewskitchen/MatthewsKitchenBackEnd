# ===== Server (let Railway inject PORT) =====
# Let Railway provide the PORT. Default to 8080 locally.
server.port=${PORT:8080}
server.address=0.0.0.0

# ===== Database (Railway injects MYSQLHOST / MYSQLPORT / MYSQLUSER / MYSQLPASSWORD / MYSQLDATABASE) =====
spring.datasource.url=jdbc:mysql://${MYSQLHOST}:${MYSQLPORT}/${MYSQLDATABASE}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
spring.datasource.username=${MYSQLUSER}
spring.datasource.password=${MYSQLPASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Hikari pool sensible defaults
spring.datasource.hikari.initializationFailTimeout=0
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.pool-name=HikariCP

# ===== JPA / Hibernate =====
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
# optional: if your DB metadata is restricted you can remove explicit dialect
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# ===== App timeouts / misc =====
spring.mail.properties.mail.smtp.connectiontimeout=30000
spring.mail.properties.mail.smtp.timeout=30000
spring.mail.properties.mail.smtp.writetimeout=30000

# ===== Email: SendGrid (HTTP) config - required for EmailService.sendViaSendGrid =====
# Set these as Railway environment variables:
# SENDGRID_API_KEY (your SendGrid API key)
# MAIL_FROM (the verified send-from address in SendGrid, e.g. verified@yourdomain.com or your verified Gmail)
sendgrid.api.key=${SENDGRID_API_KEY:}
app.mail.from=${MAIL_FROM:no-reply@mathewskitchen.com}

# ===== Optional: SMTP fallback (DISABLED by default) =====
# If you decide to use SMTP later, uncomment & configure. For production on Railway we recommend SendGrid/SES/Mailgun.
# spring.mail.host=smtp.gmail.com
# spring.mail.port=465
# spring.mail.username=${MAIL_USERNAME:}
# spring.mail.password=${MAIL_PASSWORD:}
# spring.mail.properties.mail.smtp.auth=true
# spring.mail.properties.mail.smtp.ssl.enable=true
# spring.mail.properties.mail.smtp.starttls.enable=false

# ===== Logging (helpful during deploy) =====
logging.level.root=INFO
logging.level.org.springframework=INFO
logging.level.services=INFO
